![](RackMultipart20210609-4-yc2am8_html_2454a14f757ac242.png)

# **Группа методов для управления компанией в контексте абонента «Нью-Тел» (company/\*)**

Получение информации о компании: текущее состояние, информация о сотрудниках, номерах телефонов, тарифах, расходах/company/get-members-list и пр.

Доступные методы:

[Получение информации о состоянии компании-абонента](#_30j0zll)

[Получение информации из профиля компании](#_1t3h5sf)

[Получение информации о сотрудниках компании](#_lnxbz9)

[Получение списка сотрудников компании](#_z337ya)

[Получение информации из профиля сотрудника компании](#_3whwml4)

[Получение списков номеров телефонов компании](#_2p2csry)

## **Получение информации о состоянии компании-абонента**

Метод возвращает состояние компании-абонента «Нью-Тел»: баланс, статус и пр.

ВАЖНО: это единственный метод, который возвращает данные в случае, если аккаунт компании заблокирован, например, из-за недостатка средств на счёте!

### **Наименование метода**

company/get-state

### **Атрибуты запроса**

нет

### **Пример запроса**

URI

https://api.new-tel.net/company/get-state

HEAD

Authorization: Bearer df9b7fg89n79...

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| state | Object | Да | Сведения о компании |
| - | balance | Integer | Да | Текущий баланс компании в указанной валюте расчётов. Может принимать отрицательное значение или null, если информация о балансе не предоставляется |
| - | credit | Integer | Да | Кредит для компании в указанной валюте расчётов. Может принимать значение Null, если информация о кредите не предоставляется |
| - | currency | String | Да | Валюта расчётов, возможные значения:
- &quot;RUB&quot; – российский рубль;
- &quot;EUR&quot; – евро;
- &quot;USD&quot; – доллар США.
 |
| - | dayTrafficCost | integer | Да | Расходы за последние сутки в указанной валюте расчетов |
| - | monthTrafficCost | integer | Да | Суммарные расходы за последний месяц в указанной валюте расчетов |
| - | status | String | Да | Текущий статус аккаунта компании, возможные значения:
- &quot;active&quot; – активен;
- &quot;blocked&quot; – заблокирован;
- &quot;testing&quot; – тестовый период;
- &quot;suspended&quot; – обслуживание приостановлено.
 |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;state&quot;: {

&quot;balance&quot;: -131,

&quot;credit&quot;: 0,

&quot;currency&quot;: &quot;RUB&quot;,

&quot;dayTrafficCost&quot;: 0,

&quot;monthTrafficCost&quot;: 33.08,

&quot;status&quot;: &quot;active&quot;

}

}

}

## **Получение информации из профиля компании**

Метод возвращает данные профиля компании: ID, наименование, сведения о регистрации и пр.

### **Наименование**** метода**

company/get-profile-details

### **Атрибуты запроса**

нет

### **Пример запроса**

URL

https://api.new-tel.net/company/get-profile-details

HEAD

Authorization: Bearer df9b7fg89n79...

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| profileDetails | Object | Да | Сведения из профиля компании |
| - | Id | Integer | Да | Id компании |
| - | companyName | String | Да | Сокращенное наименование компании |
| - | registeredBy | String | Да | Наименование компании - технологического партнера, если аккаунта был создан технологическим партнером. Если аккаунт был создан при самостоятельной регистрации, то null |
| - | registeredOn | Timestamp | Да | Время создания аккаунта компании, Unix timestamp |
| - | agreementNumber | String | Да | Номер договора, строка или null, если параметры договора недоступны |
| - | agreementDate | String | Да | Дата договора, строка или null, если параметры договора недоступны |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;profileDetails&quot;: {

&quot;id&quot;: 7701,

&quot;companyName&quot;: &quot;Нью-Тел Проверка системы&quot;,

&quot;registeredBy&quot;: &quot;ООО «Нью-Тел»&quot;,

&quot;registeredOn&quot;: 1607762100,

&quot;agreementNumber&quot;: &quot;7701-121220/U/CP&quot;,

&quot;agreementDate&quot;: &quot;2020-12-12&quot;

}

}

}

## **Получение информации о сотрудниках компании**

Метод возвращает данные профилей сотрудников компании: имя, email, номера телефонов и пр.

### **Наименование метода**

company/get-members

### **Атрибуты запроса**

Нет

### **Пример запроса**

URL

https://api.new-tel.net/company/get-members

HEAD

Authorization: Bearer df9b7fg89n79...

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| members | Array\_object | Да | Массив, возвращает сведения из профиля сотрудников компании |
| - | Id | Integer | Да | ID сотрудника |
| - | name | String | Да | Имя сотрудника |
| - | email | String | Да | Адрес электронной почты |
| - | internalNumber | String( | Нет | Внутренний номер телефона, строка или null, если внутренний номер не назначен |
| - | personalNumber | String | Нет | Личный номер телефона, строка или null, если личный номер не задан |
| - | timeZone | String | Нет | Временная зона |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;members&quot;: [{

&quot;id&quot;: 9423,

&quot;name&quot;: &quot;Иванов Сергей Иванович&quot;,

&quot;email&quot;: &quot;prostoforce1995@mail.ru&quot;,

&quot;internalNumber&quot;: &quot;900&quot;,

&quot;personalNumber&quot;: &quot;79311110714&quot;,

&quot;timeZone&quot;: &quot;Europe/Moscow&quot;

}]

}

}

## **Получение списка сотрудников компании**

Метод возвращает список с именами всех сотрудников компании.

### **Наименование**** метода**

company/get-members-list

### **Атрибуты запроса**

Нет

### **Пример запроса**

URL

https://api.new-tel.net/company/get-members-list

HEAD

Authorization: Bearer df9b7fg89n79...

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| membersList | Array\_string | Да | Строковой массив со списком сотрудников компании, в качестве значения передается имена сотрудников |
 |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;membersList&quot;: [&quot;Сергей&quot;, &quot;Игорь&quot;]

}

}

## **Получение информации из профиля сотрудника компании**

Метод возвращает данные профиля сотрудника компании: имя, email, номера телефонов и пр.

### **Наименование**** метода**

company/get-member-details

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| name | String(255) | Да | Имя сотрудника, строка длиной не менее 1 символа |

### **Пример запроса**

URL

https://api.new-tel.net/company/get-member-details

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;name&quot;: &quot;Игорь&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| mMembersDetails | Object | Да | Массив, возвращает сведения из профиля сотрудника компании |
| - | Id | Integer | Да | ID сотрудника |
| - | name | String | Да | Имя сотрудника. Полученное значение в ответе зависит от того, как сотрудники были заведены в личном кабинете &quot;Нью-Тел&quot;. Может быть только имя, может быть имя и фамилия, может быть полное ФИО. Может быть как на кириллице, так и на латинице. |
| - | email | String | Да | Адрес электронной почты |
| - | internalNumber | String | Да | Внутренний номер телефона, строка или null, если внутренний номер не назначен |
| - | personalNumber | String | Да | Личный номер телефона, строка или null, если личный номер не задан |
| - | timeZone | String | Да | Временная зона в текстовом формате |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Member not found | Если сотрудника компании с именем, указанном в параметре запроса name нет, будет сформировано сообщение об ошибке &quot;Member not found&quot;. |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;memberDetails&quot;: {

&quot;id&quot;: 9862,

&quot;name&quot;: &quot;Игорь&quot;,

&quot;email&quot;: &quot;shilovigor@new-tel.net&quot;,

&quot;internalNumber&quot;: &quot;303&quot;,

&quot;personalNumber&quot;: null,

&quot;timeZone&quot;: &quot;Europe/Moscow&quot;

}

}

}

## **Получение списков номеров телефонов компании**

Метод возвращает списки номеров телефонов компании, сгруппированных по типу.

### **Наименование метода**

company/get-numbers

### **Атрибуты запроса**

Нет

### **Пример запроса**

URL

https://api.new-tel.net/company/get-numbers

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| numbers | Object | Да | Объект содержит 3 массива, external, internal и virtual |
| - | external |
 | Да | Cписок внешних номеров телефонов. |
| - | internal |
 | Да | Cписок внутренних номеров телефонов. |
| - | virtual |
 | Да | Cписок виртуальных номеров телефонов. |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;numbers&quot;: {

&quot;external&quot;: [&quot;74951089830&quot;, &quot;74956408992&quot;, &quot;74997540086&quot;, &quot;78007776117&quot;, &quot;78122428679&quot;, &quot;79311110537&quot;, &quot;79311110714&quot;],

&quot;internal&quot;: [&quot;100&quot;, &quot;101&quot;, &quot;111&quot;, &quot;303&quot;, &quot;900&quot;, &quot;902&quot;],

&quot;virtual&quot;: []

}

}

}

# **Группа методов для управления аккаунтом авторизованного пользователя (user/\*)**

Получение информации из профиля пользователя, смена логина, пароля, ключей для взаимодействия по API и пр.

Доступные методы:

[Получение информации из профиля авторизованного пользователя](#_41mghml)

##


## **Получение информации из профиля авторизованного пользователя**

Метод возвращает данные профиля авторизованного пользователя-сотрудника компании: имя, email, номера телефонов. Под авторизованным пользователем понимается тот пользователь, API ключи которого используются при генерации Bearer токена.

### **Наименование**** метода**

user/get-profile-details

### **Атрибуты запроса**

Нет

### **Пример запроса**

URL

https://api.new-tel.net/user/get-profile-details

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| profileDetails | Array object | Да | Массив, возвращает сведения из профиля сотрудника компании |
| - | id | Integer | Да | ID сотрудника |
| - | name | String | Да | Имя сотрудника |
| - | email | String | Да | Адрес электронной почты |
| - | internalNumber | String | Да | Внутренний номер телефона, строка или null, если внутренний номер не назначен |
| - | personalNumber | String | Да | Личный номер телефона, строка или null, если личный номер не задан |
| - | timeZone | String | Да | Временная зона |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;profileDetails&quot;: {

&quot;id&quot;: 10185,

&quot;name&quot;: &quot;evgen&quot;,

&quot;email&quot;: &quot;boriso1155151@gmail.com&quot;,

&quot;internalNumber&quot;: &quot;902&quot;,

&quot;personalNumber&quot;: &quot;79311110537&quot;,

&quot;timeZone&quot;: &quot;Europe/Moscow&quot;

}

}

}

# **Группа методов для генерации вызовов (call/\*)**

Генерация вызовов через API, получение данных по идентификатору сгенерированного вызова.

Доступные методы:

[Инициирование простого вызова](#_3tbugp1)

[Инициирование вызова системы CallPassword](#_111kx3o)

[Инициирование голосового вызова системы CallPassword](#_p947t6tbjtfq)

[Получение идентификатора вызова в виртуальной АТС](#_1egqt2p)

##

## **Инициирование простого вызова**

Метод осуществляет соединение между номерами и источника и назначения, отображая при вызовах имеющийся внешний номер компании.

### **Наименование**** метода**

call/start-simple-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callerId | String | Да | Отображаемый номер, от 4 до 15 десятичных цифр, не начиная с 0 или с &quot;+&quot; |
| - | dstNumber | String | Да | Номер телефона назначения, от 9 до 15 десятичных цифр, не начиная с 0 или с &quot;+&quot; |
| - | srcNumber | String | Да | Номер телефона источника, от 2 до 15 десятичных цифр, не начиная с 0 или с &quot;+&quot;, можно указать несколько номеров через запятую |
| - | timeout | Integer | Нет | Время ожидания ответа в секундах, число от 20 до 99. В случае отсутствия время ожидания ответа будет установлено 20 секунд |

### **Пример запроса**

URL

https://api.new-tel.net/call/start-simple-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;callid&quot;: &quot;79168457854&quot;,

&quot;dstNumber&quot;: &quot;79035675124&quot;,

&quot;srcNumber&quot;: &quot;303&quot;,

&quot;timeout&quot;: 20

}

### **Атрибуты ответа**

свойство callId – идентификатор сгенерированного вызова, строка

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Destination and source numbers must not match | В запросе совпадают значения dstNumber и srcNumber, что не допустимо |
| 200 | Specified caller ID not allowed | Номер телефона, указанный в параметре запроса callerId не допускается |

### **Пример**** ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callId&quot;: &quot;1234567890123456&quot;

}

}

##

## **Инициирование**** вызова ****системы**  **CallPassword**

Метод осуществляет вызов на номер назначения, отображая в качестве источника номер из пула системы CallPassword для использования авторизации по звонку.

### **Наименование**** метода**

call/start-password-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | async | Integer | Да | Флаг асинхронности запроса, число 0 или 1 |
| - | dstNumber | String | Да | Номер телефона назначения, от 9 до 15 десятичных цифр, не начиная с 0 или &quot;+&quot; |
| - | pin | String | Нет | Код, который будет использован как последние 5 цифр номера источника, 5 десятичных цифр, необязательный параметр, в случае отсутствия будет сгенерирован API-сервером |
| - | timeout | Integer | Да | Время ожидания ответа в секундах, число от 20 до 99, необязательный параметр, в случае отсутствия время ожидания ответа будет установлено 20 секунд |

Примечание: при синхронном запросе (async=0) API-сервер сформрует ответ только после получения статуса вызова, определение которого может продолжаться не менее времени ожидания ответа, указанного в параметре timeout; при асинхронном (async=1) – ответ будет сформирован сразу после обработки запроса, при этом статус вызова будет неопределён.

### **Пример запроса**

URL

https://api.new-tel.net/call/start-simple-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;async&quot;: 0,

&quot;dstNumber&quot;: &quot;79035675124&quot;,

&quot;pin&quot;: &quot;41236&quot;,

&quot;timeout&quot;: 5

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| callDetails | Array object | Да | Массив, содержащий свойства |
| - | callId | Integer | Да | Идентификатор сгенерированного вызова |
| - | pin | String | Да | Пин код |
| - | status | String | Да | Статус дозвона. Строка или null |
| - | oper | String | Да | Оператор |
| - | region | String | Да | Регион |
| - | isValidNumber | String | Да | Валидность телефонного номера. Может принимать значения:
- &quot;true&quot; – номер валиден;
- &quot;false&quot; – номер не валиден
 |
| - | reasonCode | String | Да | Код причины |
| - | phoneNumber | String | Да | Номер телефона |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callDetails&quot;: {

&quot;callId&quot;: &quot;2096093321622464437&quot;,

&quot;pin&quot;: &quot;78514&quot;,

&quot;status&quot;: null,

&quot;oper&quot;: &quot;ПАО Вымпел-Коммуникации&quot;,

&quot;region&quot;: &quot;г. Москва и Московская область&quot;,

&quot;isValidNumber&quot;: true,

&quot;reasonCode&quot;: null,

&quot;phoneNumber&quot;: null

}

}

}

##

## **Инициирование голосового вызова системы CallPassword**

Метод осуществляет вызов на номер назначения, отображая в качестве источника номер из пула системы CallPassword для использования авторизации по звонку. В отличие от метода start-password-call Пин код пользователю озвучивает робот при совершении телефонного вызова.

### **Наименование**** метода**

call/start-voice-password-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | async | Integer | Да | Флаг асинхронности запроса, число 0 или 1 |
| - | dstNumber | String | Да | Номер телефона назначения, от 9 до 15 десятичных цифр, не начиная с 0 или &quot;+&quot; |
| - | text | String | Нет | Текст, который будет озвучивать робот пользователю в ходе телефонного звонка. Не более 200 символов |
| - | timeout | Integer | Да | Время ожидания ответа в секундах, число от 20 до 99, необязательный параметр, в случае отсутствия время ожидания ответа будет установлено 20 секунд |

Примечание: при синхронном запросе (async=0) API-сервер сформрует ответ только после получения статуса вызова, определение которого может продолжаться не менее времени ожидания ответа, указанного в параметре timeout; при асинхронном (async=1) – ответ будет сформирован сразу после обработки запроса, при этом статус вызова будет неопределён.

### **Пример запроса**

URL

https://api.new-tel.net/call/start-voice-simple-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;async&quot;: 0,

&quot;dstNumber&quot;: &quot;79035675124&quot;,

&quot;text&quot;: &quot;ВашПИНкод 1236&quot;,

&quot;timeout&quot;: 10

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| callDetails | Array object | Да | Массив, содержащий свойства |
| - | callId | Integer | Да | Идентификатор сгенерированного вызова |
| - | pin | String | Да | Пин код |
| - | status | String | Да | Статус дозвона. Строка или null |
| - | oper | String | Да | Оператор |
| - | region | String | Да | Регион |
| - | isValidNumber | String | Да | Валидность телефонного номера. Может принимать значения:
- &quot;true&quot; – номер валиден;
- &quot;false&quot; – номер не валиден
 |
| - | reasonCode | String | Да | Код причины или null |
| - | phoneNumber | String | Да | Номер телефона или null |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callDetails&quot;: {

&quot;callId&quot;: &quot;2096093321622464437&quot;,

&quot;pin&quot;: &quot;78514&quot;,

&quot;status&quot;: null,

&quot;oper&quot;: &quot;ПАО Вымпел-Коммуникации&quot;,

&quot;region&quot;: &quot;г. Москва и Московская область&quot;,

&quot;isValidNumber&quot;: true,

&quot;reasonCode&quot;: null,

&quot;phoneNumber&quot;: null

}

}

}

**Получение идентификатора вызова в виртуальной АТС**

Метод возвращает идентификатор вызова vbpxId для взаимодействия с вызовом в контексте виртуальной АТС.

### **Наименование метода**

call/get-vpbx-id

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callid | String | Да | Идентификатор вызова, строка |

### **Пример запроса**

URL

https://api.new-tel.net/call/get-vpbx-idl

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;callId&quot;: &quot;1234567890123456&quot;

}

### **Атрибуты ответа**

свойство vpbxId – идентификатор вызова в виртуальной АТС, строка

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found or unavailable | Если информации по указанному идентификатору callId нет (например, если вызываемый абонент не отвечает или данные о вызове уже удалёны из кеша виртуальной АТС), будет сформировано сообщение об ошибке &quot;Call not found or unavailable&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;vpbxId&quot;: &quot;da39a3ee5e6b4b0d3255bfef95601890afd80709&quot;

}

}

# **Группа методов для взаимодействия с вызовами в контексте виртуальной АТС (vpbx/\*)**

Получение данных и взаимодействие с вызовами по идентификатору вызова в виртуальной АТС

Доступные методы:

[Получение данных о вызовах за 24 часа](#_3q5sasy)

[Получение списка вызовов за 24 часа](#_43ky6rz)

[Получение данных об активных вызовах](#_1baon6m)

[Получение списка активных вызовов](#_48pi1tg)

[Получение полных данных о вызове](#_1gf8i83)

[Получение направления вызова](#_2szc72q)

[Получение статуса вызова](#_36ei31r)

[Получение времени начала вызова](#_4iylrwe)

[Получение времени ответа на вызов](#_1qoc8b1)

[Получение времени окончания вызова](#_338fx5o)

[Получение номера А входящего вызова](#_4fsjm0b)

[Получение номера Б входящего вызова](#_qbtyoq)

[Получение списка всех ответивших на входящий вызов внутренних номеров](#_302dr9l)

[Получение первого ответившего на входящий вызов внутреннего номера](#_1smtxgf)

[Получение внутреннего номера, осуществившего исходящий вызов](#_356xmb2)

[Получение номера A исходящего вызова](#_1xrdshw)

[Получение номера Б исходящего вызова](#_qbtyoq)

[Получение ссылки на звукозапись разговора](#_i17xr6)

[Получение списка внутренних номеров с успешно зарегистрированными SIP-аккаунтами](#_3fg1ce0)

[Получение списка внутренних номеров, на которыe идёт вызов](#_5v2lye1zo60r)

[Получение списка внутренних номеров, на которые идёт разговор](#_cfdrt7po7l79)

[Перехват вызова по внутреннему номеру](#_3jkaez610i7k)

[Перехват вызова по внутреннему номеру (для звонка в состоянии дозвона)](#_suxwwol7h134)

[Перехват вызова по идентификатору вызова в виртуальной АТС](#_aqeuo9i2vwbl)

[Перевод вызова на внутренний номер](#_c16wxlydvvyg)

[Подключение к внутреннему номеру для прослушивания разговора](#_khxcm54l67sc)

[Завершение активного вызова](#_i72posjph2ga)

##

## **Получение данных о вызовах за 24 часа**

Метод возвращает информацию о вызовах за 24 часа из кеша виртуальной АТС: статус, направление, номера телефонов, время.

### **Наименование метода**

vpbx/get-calls

### **Атрибуты запроса**

нет

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-calls

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| Calls | Array\_object | Да | Массив объектов, каждый из которых содержит свойства |
| - | vpbxId | String | Дв | Идентификатор вызова в виртуальной АТС |
| - | active | String | Нет | Флаг активности вызова, true или false |
| - | direction | String | Нет | Направление вызова, возможные значения:
- &quot;in&quot; – входящий вызов;
- &quot;out&quot; – исходящий вызов
 |
| - | clid | String | Да | Номер вызывающего абонента (номер А) |
| - | dnid | String | Да | Номер вызываемого абонента (номер Б) |
| - | status | String | Да | Статус вызова, возможные значения:
- &quot;answered&quot; – отвеченный вызов;
- &quot;no answer&quot; – вызов без ответа
 |
| - | startTime | Timestamp | Да | Время начала вызова, Unix timestamp |
| - | answerTime | Timestamp | Да | Время ответа на вызов, Unix timestamp или null, если вызов без ответа |
| - | endTime | Timestamp | Да | Время окончания вызова, Unix timestamp или null, если вызов активен |

**Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;calls&quot;: [{

&quot;vpbxId&quot;: &quot;e935025c738c35a3f9c2ef1f0dd90db6f921e845&quot;,

&quot;direction&quot;: &quot;out&quot;,

&quot;startTime&quot;: 1620311786,

&quot;answerTime&quot;: 1620311793,

&quot;endTime&quot;: 1620311800,

&quot;status&quot;: &quot;answered&quot;,

&quot;active&quot;: false,

&quot;clid&quot;: &quot;303&quot;,

&quot;dnid&quot;: &quot;79397085955&quot;

}]

}

}

## **Получение списка вызовов за 24 часа**

Метод возвращает список вызовов за 24 часа из кеша виртуальной АТС в виде их идентификаторов в виртуальной АТС.

### **Наименование метода**

vpbx/get-calls-list

### **Атрибуты запроса**

нет

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-calls-list

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

массив callsList – список идентификаторов вызовов в виртуальной АТС

### **Пример**** ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callsList&quot;: [

&quot;da39a3ee5e6b4b0d3255bfef95601890afd80709&quot;,

&quot;943a702d06f34599aee1f8da8ef9f7296031d699&quot;

]

}

}

##

## **Получение данных об активных вызовах**

Метод возвращает информацию о текущих активных вызовах из кеша виртуальной АТС: статус, направление, номера телефонов, время.

### **Наименование метода**

vpbx/get-active-calls

### **Атрибуты запроса**

нет

### **Пример запроса**

URL

https://api.new-tel.net/user/get-active-calls

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| activeCalls | Array\_object | Да | Массив объектов, каждый из которых содержит свойства: |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС |
| - | direction | String | Да | Направление вызова, возможные значения:
- &quot;in&quot; – входящий вызов;
- &quot;out&quot; – исходящий вызов
 |
| - | startTime | Timestamp | Да | Время начала вызова, Unix timestamp |
| - | answerTime | Timestamp | Да | Время ответа на вызов, Unix timestamp или null, если вызов без ответа |
| - | endTime | Timestamp | Да | Время окончания вызова, Unix timestamp или null |
| - | status | String | Да | Статус вызова, возможные значения:
- &quot;answered&quot; – отвеченный вызов;
- &quot;no answer&quot; – вызов без ответа
 |
| - | active | String | Да | Флаг активности вызова, всегда true |
| - | clid | String | Да | Номер вызывающего (номер А) |
| - | dnid | String | Да | Номер вызываемого (номер Б) |

### **Пример ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;activeCalls&quot;: [{

&quot;vpbxId&quot;: &quot;6e422df412d790bc7d849ef39c330defd5297854&quot;,

&quot;direction&quot;: &quot;in&quot;,

&quot;startTime&quot;: 1620397311,

&quot;answerTime&quot;: null,

&quot;endTime&quot;: 1620397312,

&quot;status&quot;: &quot;no answer&quot;,

&quot;active&quot;: true,

&quot;clid&quot;: &quot;79852638590&quot;,

&quot;dnid&quot;: &quot;78122428679&quot;

}]

}

}

## **Получение списка активных вызовов**

Метод возвращает список текущих активных вызовов из кеша виртуальной АТС в виде их идентификаторов в виртуальной АТС.

### **Наименование**** метода**

vpbx/get-active-calls-list

### **Атрибуты запроса**

нет

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-active-calls-list

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| activeCallsList | Array\_string | Да | Список идентификаторов вызовов в виртуальной АТС |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;activeCallsList&quot;: [&quot;70bf5ef3002f3075c78bd24faf2d360c6e358299&quot;]

}

}

##

## **Получение полных данных о вызове**

Метод возвращает информацию о вызове из кеша виртуальной АТС: статус, направление, номера телефонов, время.

### **Наименование**** метода**

vpbx/get-call-details

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-details

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| callDetails | Object | Да | Список идентификаторов вызовов в виртуальной АТС |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС |
| - | active | String | Да | Флаг активности вызова, true или false |
| - | direction | String | Да | Направление вызова, возможные значения:
- &quot;in&quot; – входящий вызов;
- &quot;out&quot; – исходящий вызов
 |
| - | clid | String | Да | Номер вызывающего (номер А) |
| - | dnid | String | Да | Номер вызываемого (номер Б) |
| - | status | String | Да | Статус вызова, возможные значения:
- &quot;answered&quot; – отвеченный вызов;
- &quot;no answer&quot; – вызов без ответа
 |
| - | startTime | Timestamp | Да | Время начала вызова, Unix timestamp |
| - | answerTime | Timestamp | Да | Время ответа на вызов, Unix timestamp или null, если вызов без ответа |
| - | endTime | Timestamp | Да | Время окончания вызова, Unix timestamp или null, если вызов активен |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callDetails&quot;: {

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;,

&quot;direction&quot;: &quot;in&quot;,

&quot;startTime&quot;: 1620390705,

&quot;answerTime&quot;: 1620390708,

&quot;endTime&quot;: 1620390710,

&quot;status&quot;: &quot;answered&quot;,

&quot;active&quot;: false,

&quot;clid&quot;: &quot;79616087636&quot;,

&quot;dnid&quot;: &quot;78122428679&quot;,

&quot;answeredNumbers&quot;: [&quot;101&quot;],

&quot;firstAnsweredNumber&quot;: &quot;101&quot;

}

}

}

###

## **Получение**** направления ****вызова**

Метод возвращает направление вызова.

### **Наименование метода**

vpbx/get-call-direction

### **Атрибуты**** запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-direction

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callDirection | String | Да | Направление вызова, возможные значения:
- &quot;in&quot; – входящий вызов;
- &quot;out&quot; – исходящий вызов
 |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callDirection&quot;: &quot;in&quot;

}

}

## **Получение статуса вызова**

Метод возвращает статус вызова по имеющемуся у пользователя идентификатору..

### **Наименование метода**

vpbx/get-call-status

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-status

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callStatus | String | Да | Статус вызова, возможные значения:
- &quot;answered&quot; – отвеченный вызов;
- &quot;no answer&quot; – вызов без ответа
 |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callStatus&quot;: &quot;answered&quot;

}

}

##

## **Получение времени начала вызова**

Метод возвращает время начала вызова.

### **Наименование**** метода**

vpbx/get-call-start-time

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-start-time

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callStartTime | Timestamp | Нет | Время начала вызова, Unix timestamp |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callStartTime&quot;: 1620390705

}

}

##

## **Получение времени ответа на вызов**

Метод возвращает время ответа на вызов.

### **Наименование**** метода**

vpbx/get-call-answer-time

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-answer-time

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callAnswerTime | Timestamp | Нет | Время ответа, Unix timestamp или null, если вызов без ответа |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callAnswerTime&quot;: 1620390708

}

}

##

## **Получение**** времени ****окончания**** вызова**

Метод возвращает время окончания вызова.

### **Наименование**** метода**

vpbx/get-call-end-time

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-end-time

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callEndTime | Timestamp | Нет | Время окончания вызова, Unix timestamp или null, если вызов активен. |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Данные ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callEndTime&quot;: 1620311800

}

}

##

## **Получение номера вызывающего (номера А) для входящего вызова**

Метод возвращает номер вызывающего (номер А) для входящего вызова.

### **Наименование**** метода**

vpbx/get-inbound-call-clid

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-inbound-call-clid

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callClid | String | Да | Номер вызывающего (номер А) входящего вызова. |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Method for inbound call only | Если по указанному идентификатору vpbxId имеются данные исходящего вызова, будет сформировано сообщение об ошибке &quot;Method for inbound call only&quot; |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callClid&quot;: &quot;79616087636&quot;

}

}

##

## **Получение номера вызываемого (номер Б) входящего вызова**

Метод возвращает номер вызываемого (номер Б) входящего вызова.

### **Наименование метода**

vpbx/get-inbound-call-dnid

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-inbound-call-dnid

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callDnid | String | Нет | Номер вызываемого (номер Б) входящего вызова. |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Method for inbound call only | Если по указанному идентификатору vpbxId имеются данные исходящего вызова, будет сформировано сообщение об ошибке &quot;Method for inbound call only&quot; |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callDnid&quot;: &quot;78122428679&quot;

}

}

##

## **Получение списка всех ответивших на входящий вызов внутренних номеров**

Метод возвращает список всех ответивших на входящий вызов внутренних номеров в порядке очерёдности их ответа.

### **Наименование**** метода**

vpbx/get-inbound-call-answered-numbers

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-inbound-call-answered-numbers

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callAnsweredNumbers | Array | Нет | Список всех ответивших внутренних номеров |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Method for inbound call only | Если по указанному идентификатору vpbxId имеются данные исходящего вызова, будет сформировано сообщение об ошибке &quot;Method for inbound call only&quot;. |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callAnsweredNumbers&quot;: [

&quot;79616087609&quot;,

&quot;79616087636&quot;

]

}

}

## **Получение первого ответившего на входящий вызов внутреннего номера**

Метод возвращает первый ответивший на входящий вызов внутренний номер.

### **Наименование**** метода**

vpbx/get-inbound-call-first-answered-number

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-inbound-first-answered-numbers

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callFirstAnsweredNumbers | String | Нет | Первый ответивший внутренний номер |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Method for inbound call only | Если по указанному идентификатору vpbxId имеются данные исходящего вызова, будет сформировано сообщение об ошибке &quot;Method for inbound call only&quot;. |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callFirstAnsweredNumber&quot;: &quot;101&quot;

}

}

##

## **Получение внутреннего номера, осуществившего исходящий вызов**

Метод возвращает внутренний номер, осуществивший исходящий вызов.

### **Наименование**** метода**

vpbx/get-outbound-call-internal-clid

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно вызвать методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-outbound-call-internal-clid

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callInternalClid | String | Нет | Первый ответивший внутренний номер |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Method for outbound call only | Если по указанному идентификатору vpbxId имеются данные входящего вызова, будет сформировано сообщение об ошибке &quot;Method for outbound call only&quot;. |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS: 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callInternalClid&quot;: &quot;303&quot;

}

}

##

## **Получение номера вызывающего (номера A) исходящего вызова**

Метод возвращает номер вызывающего (номер А) исходящего вызова.

### **Наименование**** метода**

vpbx/get-outbound-call-external-clid

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-outbound-call-external-clid

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callExternalClid | String | Нет | Номер вызывающего (номер А) исходящего вызова |

### **Возможные коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 200 | Method for outbound call only | Если по указанному идентификатору vpbxId имеются данные входящего вызова, будет сформировано сообщение об ошибке &quot;Method for outbound call only&quot;. |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

### **Пример**** ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callExternalClid&quot;: &quot;303&quot;

}

}

## **Получение**** номера ****Б**** исходящего ****вызова**

Метод возвращает номер вызываемого (номер Б) исходящего вызова.

### **Наименование**** метода**

vpbx/get-outbound-call-dnid

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-outbound-call-dnid

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callDnid | String | Да | Номер вызываемого (номер Б) исходящего вызова |

### **Возможные коды ошибок**

| 200 | Method for outbound call only | Если по указанному идентификатору vpbxId имеются данные входящего вызова, будет сформировано сообщение об ошибке &quot;Method for outbound call only&quot; |
| --- | --- | --- |
| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callDnid&quot;: &quot;79397085955&quot;

}

}

###


##

## **Получение ссылки на звукозапись разговора**

Метод возвращает ссылку на звукозапись разговора.

### **Наименование**** метода**

vpbx/get-call-record-link

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-call-record-link

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | callRecordLink | String | Нет | Ссылка на звукозапись разговора в формате mp3. Авторизация для прослушивания файла не нужна |

### **Возможные коды ошибок**

| 200 | Call not found | Если информации по указанному идентификатору vpbxId нет, будет сформировано сообщение об ошибке &quot;Call not found&quot; |
| --- | --- | --- |

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;callRecordLink&quot;: &quot;https://web.new-tel.net/public/audio/rec21162031178605100770106004541338&quot;

}

}

##

## **Получение списка внутренних номеров с успешно зарегистрированными SIP-аккаунтами**

Метод возвращает список внутренних номеров, на которых успешно зарегистрированы соответствующие SIP-аккаунты.

### **Наименование**** метода**

vpbx/get-registered-numbers-list

### **Атрибуты запроса**

нет

### **Пример запроса**

URL

[https://api.new-tel.net/vpbx/get-registered](https://api.new-tel.net/vpbx/get-registered)-numbers-list

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

массив registeredNumbersList – список внутренних номеров, на которых успешно зарегистрированы соответствующие SIP-аккаунты

### **Пример**** ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;registeredNumbersList&quot;: [

&quot;100&quot;,

&quot;200&quot;

]

}

}

## **Получение**** списка ****внутренних**** номеров ****,**  **на**** которые ****идёт**** вызов**

Метод возвращает список внутренних номеров, на которые идёт вызов.

### **Наименование**** метода**

vpbx/get-ringing-numbers-list

### **Атрибуты запроса**

Нет

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-ringin-numbers-list

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

массив ringingNumbersList – список внутренних номеров, на которые идёт вызов

### **Пример**** ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;ringingNumbersList&quot;: [

&quot;100&quot;,

&quot;200&quot;

]

}

}

## **Получение списка внутренних номеров, на которых идёт разговор**

Метод возвращает список внутренних номеров, на которые идёт разговор.

### **Наименование**** метода**

vpbx/get-active-numbers-list

### **Атрибуты запроса**

Нет

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/get-active-numbers-list

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{}

### **Атрибуты ответа**

массив activeNumbersList – список внутренних номеров, на которых идёт разговор

### **Пример**** ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;,

&quot;activeNumbersList&quot;: [

&quot;100&quot;,

&quot;200&quot;

]

}

}

##

## **Перехват**** вызова ****по**** внутреннему ****номеру**

Метод позволяет перехватить звонок по идентификатору вызова

### **Наименование**** метода**

vpbx/get-pickup-call-by-number

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |
| - | toNumber | String | Да | Внутренний номер, который ответит на звонок. 2-4 цифры, целые |
| - | ringingNumber | String | Да | Внутренний номер, на который идет звонок. 2-4 цифры, целые |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/transfer-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxid&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;,

&quot;toNumber&quot;: 303

}

### **Атрибуты**** ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | result | String | Да | Объект result – может принимать одно из 2-х значений:
- &quot;success&quot; - подключение произошло;
- &quot;error&quot; - подключения не произошло
 |

### **Пример ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;

}

}

## **Перехват вызова по внутреннему номеру (для звонка в состоянии дозвона)**

Метод позволяет перехватить любой вызов по идентификатору вызова для звонка в состоянии дозвона

### **Наименование метода**

vpbx/pickup-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |
| - | toNumber | String | Да | Внутренний номер, который ответит на звонок. 2-4 цифры, целые |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/pickup-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxId&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;,

&quot;toNumber&quot;: 303

}

### **Атрибуты**** ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | result | String | Да | Объект result – может принимать одно из 2-х значений:
- &quot;success&quot; - подключение произошло;
- &quot;error&quot; - подключения не произошло
 |

### **Пример ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;

}

}

## **Перевод вызова на внутренний номер**

Метод позволяет перевести любой звонок на внутренний номер

### **Наименование метода**

vpbx/transfer-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |
| - | toNumber | String | Да | Внутренний номер, который ответит на звонок. 2-4 цифры, целые |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/transfer-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxid&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;,

&quot;toNumber&quot;: 303

}

### **Атрибуты**** ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | result | String | Да | Объект result – может принимать одно из 2-х значений:
- &quot;success&quot; - подключение произошло;
- &quot;error&quot; - подключения не произошло
 |

### **Пример ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;

}

}

## **Подключение к внутреннему номеру для прослушивания разговора**

Метод. позволяет прослушать разговор путем подключения к внутреннему номеру.

### **Наименование метода**

vpbx/listen-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |
| - | toNumber | String | Да | Внутренний номер, который ответит на звонок. 2-4 цифры, целые |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/listen-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxid&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;,

&quot;toNumber&quot;: 303

}

### **Атрибуты**** ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | result | String | Да | Объект result – может принимать одно из 2-х значений:
- &quot;success&quot; - подключение произошло;
- &quot;error&quot; - подключения не произошло
 |

### **Пример ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;

}

}

## **Завершение активного вызова**

Метод позволяет принудительно завершить звонок по идентификатору вызова.

### **Наименование метода**

vpbx/get/hangup-call

### **Атрибуты запроса**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | vpbxId | String | Да | Идентификатор вызова в виртуальной АТС, 40 шестнадцатеричных цифр в нижнем регистре, который можно получить методами:
- call/get-vpbx-id;
- vpbx/get-calls-list;
- vpbx/get-active-calls-list;
- vpbx/get-call-details
 |

### **Пример запроса**

URL

https://api.new-tel.net/vpbx/hangup-call

HEAD

Authorization: Bearer df9b7fg89n79…

Content-Type: application/json

BODY

{

&quot;vpbxid&quot;: &quot;402ec8f63d1c6eb2b59948c67181bc196a52f160&quot;

}

### **Атрибуты ответа**

| **Атрибут** | **Тип данных** | **Обяз.** | **Примечание** |
| --- | --- | --- | --- |
| - | result | String | Да | Объект result – может принимать одно из 2-х значений:
- &quot;success&quot; - подключение произошло;
- &quot;error&quot; - подключения не произошло
 |

### **Пример ответа**

STATUS 200 OK

BODY

{

&quot;status&quot;: &quot;success&quot;,

&quot;data&quot;: {

&quot;result&quot;: &quot;success&quot;

}

}

#


# **Коды ошибок**

| **HTTP-статус** | **Текст ошибки** | **Примечание** |
| --- | --- | --- |
| 405 | Method Not Allowed | Неверный метод запроса (например, GET).
Также дополнительно будет заголовок ответа:Allow: POST сообщение в свойстве ответа &quot;message&quot;:
&quot;GET not allowed&quot; (указывается именно текущий метод запроса). |
| 406 | Not Acceptable | Неверный заголовок &#39;​Accept&#39;. |
| 415 | Unsupported Media Type | Отсутствует заголовок &#39;​Content-Type&#39;.
Сообщение в свойстве ответа &quot;message&quot;: &quot;Content-Type not set&quot; |
| 415 | Unsupported Media Type | Неверный заголовок &#39;​Content-Type&#39;.
Сообщение в свойстве ответа &quot;message&quot;: &quot;Content-Type &#39;xxx&#39; not supported&quot; (указывается именно текущее значение заголовка). |
| 400 | Bad Request | Неверные данные для авторизации (при отсутствии заголовка Authorization или неверном формате данных в заголовке).
Также дополнительно будет заголовок ответа:WWW-Authenticate: Bearer error=&quot;invalid\_request&quot;сообщение в свойстве ответа &quot;message&quot;: &quot;Invalid authorization data&quot;. |
| 401 | Unauthorized | Авторизация не удалась (неверный или неактуальный/устаревший ключ).
Также дополнительно будет заголовок ответа: WWW-Authenticate: Bearer error=&quot;invalid\_token&quot; сообщение в свойстве ответа &quot;message&quot;: &quot;Authorization failed&quot;. |
| 400 | Bad Request
 | Неверная подпись запроса (вычислена неверно).
Cообщениевсвойствеответа &quot;message&quot;:&quot;Invalid request signature&quot;. |
| 402 | Bad Request | Метка времени находится за пределами допустимого диапазона.
Cообщение в свойстве ответа &quot;message&quot;:&quot;Invalid request timestamp&quot;. |
| 403 | 403 Forbidden | Доступ запрещён (на данный момент только, когда аккаунт компании заблокирован).
Также дополнительно будет заголовок ответа. WWW-Authenticate: Bearer error= `insufficient_scope` исообщениевсвойствеответа &quot;message&quot;: `Access denied` |
| 404 | Not Found
 | Метод не существует. Сообщение в свойстве ответа &quot;message&quot;: `Requested method not found` |
| 423 | Bad Request | Неверный формат данных запроса (при значении заголовка &#39;Content-Type&#39; как &#39;application/json&#39;).
Сообщение в свойстве ответа &quot;message&quot;:`Invalid JSON data` |
| 422 | Unprocessable entity | Неверные или отсутствующие параметры запроса. Отсутствуют несколько обязательных параметров.Cообщение в свойстве ответа &quot;message&quot;: `Required parameters missing: &#39;paramName1&#39;, &#39;paramName2&#39;, &#39;paramName3` |
| 422 | Unprocessable entity | Неверные или отсутствующие параметры запроса. Отсутствует один обязательный параметр.
Cообщение в свойстве ответа &quot;message&quot;: `Required parameter missing: &#39;paramName` |
| 422 | Unprocessable entity | Неверные или отсутствующие параметры запроса. Неверный формат или данные в нескольких параметрах (только если присутствуют все обязательные параметры).
Cообщениевсвойствеответа &quot;message&quot;: `Invalid parameters: &#39;paramName1&#39;, &#39;paramName2&#39; |
| 422 | Unprocessable entity | Неверные или отсутствующие параметры запроса. Неверный формат или данные параметра (только если присутствуют все обязательные параметры).
Cообщениевсвойствеответа &quot;message&quot;: &#39;Invalid parameter: `paramName` |

1